= Export a preference in DOT format

====== link:../README.adoc[Summary]

=== Export Preference in DOT Format

image:../assets/export_in_dotformat_diag_class.PNG[Export in DOT format - Class Diagram]


=== What will do this class +

The goal of the ExportDOT class is to export a preference in link:./GUIInputFiles.adoc[DOT format]. 

A preference can be represented by a *directed* graph. The preference interface has a method link:./preferenceInterfaces.adoc[asGraph()] which returns a preference as a link:https://jgrapht.org/javadoc/org.jgrapht.core/org/jgrapht/Graph.html[Graph] _(*)_. So all preferences can be converted into a graph and given to the export() method of the ExportDOT class.

The export() method of the ExportDOT class verify that the provided graph is a directed graph or not and then converts it to DOT format. Finally, the link:https://docs.oracle.com/javase/7/docs/api/java/io/Writer.html[Writer] given as argument provides an output stream to a file. We can create a link:https://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html[PrintWriter] on this stream and write in the file (see the next example for more informations about write stream). 

----
//Create a string by using StringBuilder by preference
StringBuilder dot = new StringBuilder();
dot.append("inputString-DOTformat");

//Create a Writer from the OutputStream - the output is the destination
Writer writer =new BufferedWritter(new OutputStream(output));

//Give the String to the Writer
writer.write(dot)
//You can also use the append() method of the Writer
writer.append(dot)
----

== Export Preference in DOT format methods analysis +

[cols="1,1,2", options="header"] 
|===
|Method name
|Contract
|Relevance

|export(Graph pref, OutputStream stream)
|This is a static void method which takes two argument : a graph that represents a preference and a OutputStream (provides an output stream to a file) which export it in DOT format. It would be useful to verify that the export method receives a directed graph or not by using the isDirectedGraph() method. Then convertToDot() converts the graph and sends the string to the Writer given by the OutputStream to write in the output file. 
|To do

|isDirectedGraph(Graph g)
|This is a static method which returns true when the argument is a directed graph.  
|To do

|convertToDoT(DirectedGraph g)
|This is a static method which returns the directed graph in DOT Format as String.
|To do

|===

_(*) Be carefull, currently the asGraph() method of the Preference interface returns a Graph. We can't be sure that the returned Graph is a directed graph. This can be a problem because usually a connection between two vertices of a graph is represented by "--" and by "->" for a directed graph in DOT format. Thus the conversion might not be good._


= Import Profile


=== Import Profile from several data formats by ReadProfile

image:../assets/readprofile_diag_class.PNG[Import profile - Class Diagram]


=== Read/describe Profile from ODS files

ODS files are worksheet files that are used in OpenOffice, for example. 
link:./GUIInputFiles.adoc[Here] we have defined several data formats for ODS files: RanksFormat, VotersToRanking, and CountOfRanking.
The ReadODS class allows to read and describe profiles from these data formats.  

image:../assets/readods_diag_class.PNG[Read a profile with readODS - Class Diagram]


[cols="1,1,2", options="header"] 
|===
|Method name
|Contract
|Relevance

|checkFormatandPrint(InputStream in)
|This is a static method wich check the data format of the input stream (RanksFormat or VotersToRanking or CountOfRanking) and return a string with voting information by using on of the next printFormat method.
|Ok 

|printFormatCountOfRanking(Table table)
|This is a string static method which takes an ods table containing voting information in argument, and return a string with voting information. It is used to describe the information contained.
|Ok

|printFormatRanksFormat(Table table)
|This is a string static method which takes an ods table containing voting information in argument, and return a string with voting information. It is used to describe the information contained.
|Ok

|printFormatVotersToRanking(Table table)
|This is a string static method which takes an ods table containing voting information in argument, and return a string with voting information. It is used to describe the information contained.
|Ok

|getAlternatives(Table table)
|This is a static method which takes an ods table containing voting information in argument and returns an list of Alternatives.
|Ok

|getnbToVoters(Table table)
|This is a static method which takes an ods table containing voting information in argument and returns the number (integer) of voters.
|Ok

|checkFormatandReturnCompletePreference(InputStream in)
|
|Ok

|completeFormatRanksFormat(Table table)
|
|Ok

|completeFormatVotersToRankings(Table table)
|
|Ok